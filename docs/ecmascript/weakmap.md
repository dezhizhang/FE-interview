# Map 和 WeakMap 的区别

`Map` 和 `WeakMap` 是 JavaScript 中两种用于存储键值对的集合数据结构，但它们在特性、用途和内存管理方面有显著的区别。

## 1. 基本概念

### Map

- **定义**：`Map` 是一种集合类型，允许存储任意类型的键值对，包括对象、函数和基本类型。
- **特性**：
  - 键可以是任何类型（包括对象和基本类型）。
  - 按插入顺序迭代，保持键值对的顺序。
  - 提供 `size` 属性以获取 Map 中键值对的数量。
  - 对键和值持有强引用，防止被垃圾回收。

### WeakMap

- **定义**：`WeakMap` 是一种弱引用的键值对集合，只能存储对象作为键，值可以是任意类型。
- **特性**：
  - 键只能是对象，基本类型不可用。
  - 对于键的引用是弱引用，如果没有其他引用指向该对象，则该键值对会被垃圾回收。
  - 不支持 `size` 属性和遍历操作（如 `forEach`、`keys`、`values` 等）。

## 2. API 对比

| 方法          | Map              | WeakMap            |
|---------------|------------------|--------------------|
| `set(key, value)` | 设置键值对   | 只能使用对象作为键  |
| `get(key)`    | 获取指定键的值  | 获取指定对象的值    |
| `has(key)`    | 检查键是否存在   | 检查对象键是否存在  |
| `delete(key)` | 删除指定键值对  | 删除指定对象键值对  |
| `clear()`     | 清空所有键值对  | 不可用             |
| `size`        | 支持             | 不支持             |
| 遍历          | 支持             | 不支持             |

## 3. 应用场景

### Map

- **存储关联数据**：用于存储需要快速查找的键值对，例如缓存、配置选项等。
- **有序集合**：当需要按插入顺序迭代键值对时，`Map` 提供了便利。
- **复杂键**：支持使用对象、函数等复杂类型作为键。

### WeakMap

- **内存管理**：由于 WeakMap 对对象的弱引用特性，适合用于管理那些可能被其他代码清理的对象，避免内存泄漏。
- **私有数据**：可以存储对象的私有属性或状态，确保这些数据在对象不再被引用时能被垃圾回收。
- **事件处理**：用于存储与事件相关的对象，确保在对象不再使用时能够被清理。

## 4. 总结

- `Map` 和 `WeakMap` 都是用于存储键值对的集合，但 `Map` 支持任意类型的键，而 `WeakMap` 仅支持对象作为键且持有弱引用。
- `Map` 提供更多的功能和灵活性，而 `WeakMap` 适合在需要内存管理和私有数据的场景中使用。

选择合适的数据结构可以在 JavaScript 开发中更有效地管理数据。
